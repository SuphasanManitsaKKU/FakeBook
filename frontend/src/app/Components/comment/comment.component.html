<div class="comments mt-6">
  <!-- ‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á Parent Comments -->
  <ng-container *ngFor="let comment of parentComments">
    <div class="comment mb-4 p-4 bg-gray-100 rounded-lg flex items-start w-full">
      <img [src]="comment.user.imageProfile ? comment.user.imageProfile : 'default-profile.png'" alt="Profile Image"
        class="w-10 h-10 rounded-full mr-3" />

      <div class="w-full">
        <p class="text-sm font-semibold">{{ comment.user.username }}</p>
        <p class="text-gray-700 text-base">{{ comment.message }}</p>

        <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≤‡∏á ‡πÜ -->
        <div class="flex gap-2 mt-2">
          <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ä‡∏±‡πâ‡∏ô) -->
          <button *ngIf="getCommentDepth(comment) < 3" class="text-blue-500 hover:underline"
            (click)="startReply(comment.id)">
            ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
          </button>

          <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ä‡∏±‡πâ‡∏ô) -->
          <button *ngIf="comment.user.id == userId && getCommentDepth(comment) <= 3"
            class="text-yellow-500 hover:underline" (click)="startEdit(comment)">
            ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
          </button>

          <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ä‡∏±‡πâ‡∏ô) -->
          <button *ngIf="comment.user.id == userId && getCommentDepth(comment) <= 3"
            class="text-red-500 hover:underline" (click)="deleteComment(comment.id)">
            ‡∏•‡∏ö
          </button>
        </div>

        <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á input-comment ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö -->
        <div *ngIf="replyingToCommentId == comment.id" class="mt-2">
          <app-input-comment [postId]="postId" [parentCommentId]="comment.id"
            (commentAdded)="onCommentAddedFromChild()"></app-input-comment>
          <button class="text-gray-500 mt-2" (click)="stopReply()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>

        <!-- ‚úÖ ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏•‡∏π‡∏Å‡πÅ‡∏ö‡∏ö‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÅ‡∏Ñ‡πà 3 ‡∏ä‡∏±‡πâ‡∏ô -->
        <div class="nested-comments mt-4 ml-4 border-l border-gray-300 pl-3 w-[97.5%]">
          <ng-container *ngIf="getCommentDepth(comment) < 3">
            <ng-container *ngFor="let reply of repliesMap[comment.id]">
              <div class="reply mb-2 p-3 bg-gray-200 rounded-lg flex items-start w-full">
                <img [src]="reply.user.imageProfile ? reply.user.imageProfile : 'default-profile.png'"
                  alt="Profile Image" class="w-8 h-8 rounded-full mr-3" />
                <div class="w-full">
                  <p class="text-sm font-semibold">{{ reply.user.username }}</p>
                  <p class="text-gray-700 text-sm">{{ reply.message }}</p>
                  <div class="flex gap-2 mt-1">
                    <button *ngIf="getCommentDepth(reply) < 3" class="text-blue-500 hover:underline"
                      (click)="startReply(reply.id)">
                      ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
                    </button>

                    <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ä‡∏±‡πâ‡∏ô) -->
                    <button *ngIf="reply.user.id == userId && getCommentDepth(reply) <= 3"
                      class="text-yellow-500 hover:underline" (click)="startEdit(reply)">
                      ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                    </button>

                    <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ä‡∏±‡πâ‡∏ô) -->
                    <button *ngIf="reply.user.id == userId && getCommentDepth(reply) <= 3"
                      class="text-red-500 hover:underline" (click)="deleteComment(reply.id)">
                      ‡∏•‡∏ö
                    </button>
                  </div>
                </div>
              </div>

              <!-- ‚úÖ ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 3 -->
              <div class="nested-comments mt-4 ml-4 border-l border-gray-300 pl-3 w-[95%]">
                <ng-container *ngIf="getCommentDepth(reply) < 3">
                  <ng-container *ngFor="let subReply of repliesMap[reply.id]">
                    <div class="reply mb-2 p-3 bg-gray-300 rounded-lg flex items-start w-full">
                      <img [src]="subReply.user.imageProfile ? subReply.user.imageProfile : 'default-profile.png'"
                        alt="Profile Image" class="w-6 h-6 rounded-full mr-3" />
                      <div class="w-full">
                        <p class="text-sm font-semibold">{{ subReply.user.username }}</p>
                        <p class="text-gray-700 text-sm">{{ subReply.message }}</p>
                        <div class="flex gap-2 mt-1">
                          <!-- ‚úÖ ‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 3 ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö -->
                          <button *ngIf="getCommentDepth(subReply) < 3" class="text-blue-500 hover:underline"
                            (click)="startReply(subReply.id)">
                            ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
                          </button>

                          <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ä‡∏±‡πâ‡∏ô) -->
                          <button *ngIf="subReply.user.id == userId" class="text-yellow-500 hover:underline"
                            (click)="startEdit(subReply)">
                            ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                          </button>

                          <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ä‡∏±‡πâ‡∏ô) -->
                          <button *ngIf="subReply.user.id == userId" class="text-red-500 hover:underline"
                            (click)="deleteComment(subReply.id)">
                            ‡∏•‡∏ö
                          </button>
                        </div>
                      </div>
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </ng-container>
          </ng-container>
        </div>
      </div>
    </div>
  </ng-container>

  <!-- üîπ InputComment ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà (‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡πÉ‡∏Ñ‡∏£) -->
  <div class="mt-6">
    <app-input-comment [postId]="postId" [parentCommentId]="null"
      (commentAdded)="loadComments(); onCommentAddedFromChild()">
    </app-input-comment>
  </div>
</div>